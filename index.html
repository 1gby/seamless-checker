<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rudeboy‚Ñ¢ Seamless Pattern Checker</title>
<style>
*{box-sizing:border-box}
body{margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;background:linear-gradient(135deg,#0a0a0a 0%,#1a1a2e 100%);color:#eee;min-height:100vh}
#container{display:flex;flex-direction:column;min-height:100vh}
#header{padding:1.5rem 2rem;background:rgba(26,26,46,0.8);backdrop-filter:blur(10px);border-bottom:1px solid rgba(255,255,255,0.1);display:flex;align-items:center;justify-content:space-between;gap:1rem;flex-wrap:wrap}
.logo-section{display:flex;align-items:center;gap:1rem}
#logo{height:42px;width:auto;cursor:pointer;transition:transform 0.3s,filter 0.3s;filter:drop-shadow(0 0 0px rgba(16,185,129,0));animation:pulse 2s ease-in-out infinite}
@keyframes pulse{0%,100%{filter:drop-shadow(0 0 0px rgba(16,185,129,0))}50%{filter:drop-shadow(0 0 6px rgba(16,185,129,1)) drop-shadow(0 0 12px rgba(16,185,129,1))}}
#logo:hover{transform:scale(1.05)}
#logo:active{animation:glow-pulse 0.4s ease-out;transform:scale(0.98)}
@keyframes glow-pulse{0%{filter:drop-shadow(0 0 0px rgba(16,185,129,0))}50%{filter:drop-shadow(0 0 20px rgba(16,185,129,1)) drop-shadow(0 0 30px rgba(16,185,129,0.8))}100%{filter:drop-shadow(0 0 0px rgba(16,185,129,0))}}
.title{font-size:1.5rem;font-weight:700;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin:0}
.header-buttons{display:flex;align-items:stretch;gap:0.75rem;flex-wrap:nowrap;justify-content:center;width:100%;max-width:600px}
.file-input-wrapper{position:relative;overflow:hidden;display:flex;flex:1}
.file-input-wrapper input[type=file]{position:absolute;left:-9999px}
.upload-btn,.export-btn-header,.sample-btn{padding:0.75rem 1rem;color:white;border:none;border-radius:12px;font-size:0.9rem;font-weight:600;cursor:pointer;transition:all 0.3s;width:100%;white-space:nowrap;text-align:center;flex:1;display:flex;align-items:center;justify-content:center}
.upload-btn{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);box-shadow:0 4px 15px rgba(102,126,234,0.3)}
.sample-btn{background:linear-gradient(135deg,#f59e0b 0%,#d97706 100%);box-shadow:0 4px 15px rgba(245,158,11,0.3)}
.export-btn-header{background:linear-gradient(135deg,#10b981 0%,#059669 100%);box-shadow:0 4px 15px rgba(16,185,129,0.3)}
.upload-btn:hover,.sample-btn:hover,.export-btn-header:hover{transform:translateY(-2px)}
.upload-btn:active{box-shadow:0 4px 15px rgba(102,126,234,0.3),0 0 25px rgba(102,126,234,0.6);animation:btn-glow 0.4s ease-out}
.sample-btn:active{box-shadow:0 4px 15px rgba(245,158,11,0.3),0 0 25px rgba(245,158,11,0.6);animation:btn-glow 0.4s ease-out}
.export-btn-header:active{box-shadow:0 4px 15px rgba(16,185,129,0.3),0 0 25px rgba(16,185,129,0.6);animation:btn-glow 0.4s ease-out}
@keyframes btn-glow{0%{box-shadow:0 4px 15px rgba(102,126,234,0.3),0 0 0px rgba(102,126,234,0)}50%{box-shadow:0 4px 15px rgba(102,126,234,0.5),0 0 30px rgba(102,126,234,0.8)}100%{box-shadow:0 4px 15px rgba(102,126,234,0.3),0 0 0px rgba(102,126,234,0)}}
.export-btn-header:disabled{opacity:0.5;cursor:not-allowed;transform:none}
#canvas-wrapper{flex:1;display:flex;align-items:center;justify-content:center;padding:2rem;position:relative}
#canvas{max-width:1200px;width:100%;aspect-ratio:1;border-radius:20px;box-shadow:0 20px 60px rgba(0,0,0,0.5);cursor:pointer;transition:all 0.3s}
#canvas.has-image{cursor:grab}
#canvas.has-image:active{cursor:grabbing}
#canvas:hover{box-shadow:0 25px 70px rgba(0,0,0,0.6)}
.empty-state{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;pointer-events:none;opacity:0;transition:opacity 0.3s}
.empty-state.visible{opacity:1}
.empty-state-icon{font-size:4rem;margin-bottom:1rem;opacity:0.6}
.empty-state-text{font-size:1.25rem;font-weight:600;margin-bottom:0.5rem;color:#888}
.empty-state-subtext{font-size:0.95rem;color:#666}
.loading-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.8);backdrop-filter:blur(10px);display:none;align-items:center;justify-content:center;z-index:10000;opacity:0;transition:opacity 0.3s}
.loading-overlay.visible{display:flex;opacity:1}
.loading-logo{width:80px;height:80px;opacity:0.6;animation:spin 1.5s linear infinite}
@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
#controls{padding:2rem;background:rgba(26,26,46,0.8);backdrop-filter:blur(10px);border-top:1px solid rgba(255,255,255,0.1)}
.controls-row{display:flex;gap:1.5rem;justify-content:center;flex-wrap:wrap;align-items:center;margin-bottom:1.5rem}
.dropdowns-row{display:flex;gap:1.5rem;justify-content:center;align-items:stretch;margin-bottom:1rem;flex-wrap:wrap}
.dropdown-section{flex:1;min-width:280px}
.controls-sliders{display:flex;gap:2rem;justify-content:center;flex-wrap:wrap;align-items:flex-start;transition:all 0.3s;max-height:0;overflow:hidden;row-gap:2.5rem;padding-bottom:0}
.controls-sliders.open{max-height:1000px;padding-bottom:1.5rem}
.controls-header{width:100%;text-align:center;cursor:pointer;padding:1rem;border-radius:16px;transition:all 0.3s;user-select:none;font-weight:700;font-size:0.95rem;letter-spacing:1px;text-transform:uppercase;background:rgba(255,255,255,0.05);backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,0.1);box-shadow:0 8px 32px rgba(0,0,0,0.3),inset 0 1px 0 rgba(255,255,255,0.1)}
.controls-header:hover{background:rgba(255,255,255,0.08);box-shadow:0 8px 32px rgba(0,0,0,0.4),inset 0 1px 0 rgba(255,255,255,0.15)}
.controls-header:active{transform:scale(0.98)}
.controls-header.purple{background:linear-gradient(135deg,#764ba2 0%,#10b981 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.controls-header.green{background:linear-gradient(135deg,#10b981 0%,#764ba2 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.controls-header.open.purple{box-shadow:0 8px 32px rgba(118,75,162,0.4),inset 0 1px 0 rgba(255,255,255,0.2),0 0 20px rgba(118,75,162,0.3)}
.controls-header.open.green{box-shadow:0 8px 32px rgba(16,185,129,0.4),inset 0 1px 0 rgba(255,255,255,0.2),0 0 20px rgba(16,185,129,0.3)}
.control-group{display:flex;flex-direction:column;gap:0.5rem;min-width:180px;align-items:center}
.control-label{font-size:0.85rem;font-weight:600;color:#aaa;text-transform:uppercase;letter-spacing:0.5px;text-align:center}
select,button{padding:0.75rem 1rem;font-size:0.95rem;border-radius:12px;border:1px solid rgba(255,255,255,0.1);background:rgba(255,255,255,0.05);color:#eee;cursor:pointer;transition:all 0.3s;font-family:inherit;width:100%}
select:hover,button:hover{background:rgba(255,255,255,0.1);border-color:rgba(102,126,234,0.5)}
select:focus,button:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px rgba(102,126,234,0.2),0 0 20px rgba(102,126,234,0.4)}
select:active,button:active{box-shadow:0 0 0 3px rgba(102,126,234,0.2),0 0 25px rgba(102,126,234,0.6)}
.slider-group{display:flex;flex-direction:column;gap:0.5rem;min-width:180px}
.slider-header{display:flex;justify-content:space-between;align-items:center}
input[type="range"]{width:100%;height:6px;border-radius:3px;background:rgba(255,255,255,0.1);outline:none;-webkit-appearance:none;transition:all 0.3s}
input[type="range"]:active{background:rgba(255,255,255,0.15)}
input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;width:18px;height:18px;border-radius:50%;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);cursor:pointer;box-shadow:0 2px 8px rgba(102,126,234,0.4);transition:all 0.3s}
input[type="range"]::-webkit-slider-thumb:hover{transform:scale(1.2);box-shadow:0 2px 8px rgba(102,126,234,0.6)}
input[type="range"]::-webkit-slider-thumb:active{box-shadow:0 2px 8px rgba(102,126,234,0.6),0 0 20px rgba(102,126,234,0.8);animation:thumb-glow 0.4s ease-out}
@keyframes thumb-glow{0%{box-shadow:0 2px 8px rgba(102,126,234,0.6),0 0 0px rgba(102,126,234,0)}50%{box-shadow:0 2px 8px rgba(102,126,234,0.8),0 0 25px rgba(102,126,234,1)}100%{box-shadow:0 2px 8px rgba(102,126,234,0.6),0 0 0px rgba(102,126,234,0)}}
input[type="range"]::-moz-range-thumb{width:18px;height:18px;border-radius:50%;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);cursor:pointer;border:none;box-shadow:0 2px 8px rgba(102,126,234,0.4);transition:all 0.3s}
input[type="range"]::-moz-range-thumb:hover{transform:scale(1.2);box-shadow:0 2px 8px rgba(102,126,234,0.6)}
input[type="range"]::-moz-range-thumb:active{box-shadow:0 2px 8px rgba(102,126,234,0.6),0 0 20px rgba(102,126,234,0.8)}
.slider-value{font-size:0.9rem;font-weight:600;color:#667eea;min-width:45px;text-align:right}
#footer{padding:2rem;background:rgba(10,10,10,0.9);border-top:1px solid rgba(255,255,255,0.1)}
.footer-content{max-width:1200px;margin:0 auto;text-align:center}
.footer-title{font-size:1.1rem;font-weight:600;margin-bottom:1rem;color:#aaa}
.footer-links{display:flex;flex-wrap:wrap;gap:1.5rem;justify-content:center;margin-bottom:1.5rem}
.footer-links a{color:#667eea;text-decoration:none;font-size:0.95rem;transition:all 0.3s;padding:0.5rem 1rem;border-radius:8px;background:rgba(102,126,234,0.1)}
.footer-links a:hover{background:rgba(102,126,234,0.2);transform:translateY(-2px)}
.footer-links a:active{box-shadow:0 0 20px rgba(102,126,234,0.6)}
.footer-credit{margin-top:1.5rem;padding-top:1.5rem;border-top:1px solid rgba(255,255,255,0.1);font-weight:700;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-size:1.1rem}
.pattern-info{text-align:center;padding:1rem;color:#888;font-size:0.9rem;display:none}
.pattern-info.visible{display:block}
@media(max-width:768px){
#header{padding:1rem;flex-direction:column;align-items:stretch}
.logo-section{justify-content:center}
.header-buttons{gap:0.5rem;padding:0;max-width:100%}
.title{font-size:1.2rem}
#canvas-wrapper{padding:1rem}
#controls{padding:1.5rem 1rem}
.control-group,.slider-group{min-width:140px}
.controls-row{gap:0.75rem}
.control-group{min-width:45%;flex:1}
.dropdown-section{min-width:100%}
}
</style>
</head>
<body>
<div id="container">
<div id="header">
<div class="logo-section">
<img id="logo" src="https://raw.githubusercontent.com/1gby/seamless-checker/main/assets/icons/icon.png" alt="Rud3boy Logo">
<h1 class="title">Pattern Checker By Rudeboy‚Ñ¢</h1>
</div>
<div class="header-buttons">
<div class="file-input-wrapper">
<input type="file" id="fileInput" accept="image/*">
<button class="upload-btn" id="uploadBtnHeader">üìÅ Upload</button>
</div>
<div class="file-input-wrapper">
<select class="sample-btn" id="sampleSelect">
<option value="">Sample</option>
<option value="https://raw.githubusercontent.com/1gby/seamless-checker/main/assets/patterns/Seamless.png">Seamless</option>
<option value="https://raw.githubusercontent.com/1gby/seamless-checker/main/assets/patterns/Mushrooms.png">Mushrooms</option>
<option value="https://raw.githubusercontent.com/1gby/seamless-checker/main/assets/patterns/JoltCola.png">Jolt Cola</option>
</select>
</div>
<button class="export-btn-header" id="exportBtnHeader" disabled>üì§ Share</button>
</div>
</div>
<div id="canvas-wrapper">
<canvas id="canvas"></canvas>
<div class="empty-state visible" id="emptyState">
<div class="empty-state-icon">üé®</div>
<div class="empty-state-text">Click to upload your pattern</div>
<div class="empty-state-subtext">or drag & drop a square tile here</div>
</div>
</div>
<div id="controls">
<div class="controls-row">
<div class="control-group">
<label class="control-label">Canvas Quality</label>
<select id="canvasQuality">
<option value="1200">Standard (1200px)</option>
<option value="1600">High (1600px)</option>
<option value="2400">Ultra (2400px)</option>
<option value="3200">Max (3200px)</option>
</select>
</div>
<div class="control-group">
<label class="control-label">Repeat Type</label>
<select id="repeatType">
<option value="full">Full Drop</option>
<option value="half-drop">Half Drop</option>
<option value="brick">Brick</option>
</select>
</div>
</div>
<div class="controls-row">
<div class="control-group">
<label class="control-label">View Mode</label>
<select id="viewMode">
<option value="tile">Infinite Tile</option>
<option value="tile-grid">Infinite Tile + Grid</option>
<option value="phone">Phone Case</option>
<option value="ipad">iPad Case</option>
<option value="tote">Tote Bag</option>
<option value="bandana">Bandana</option>
<option value="bedspread">Bedspread</option>
<option value="mug">Mug</option>
<option value="fabric">Fabric Swatch</option>
<option value="bottle">Water Bottle</option>
</select>
</div>
<div class="control-group">
<label class="control-label">Background</label>
<select id="bgColor">
<option value="checker">Transparent Grid</option>
<option value="#000000">Black</option>
<option value="#ffffff">White</option>
<option value="#1a1a1a">Gray</option>
</select>
</div>
</div>
<div class="dropdowns-row">
<div class="dropdown-section">
<div class="controls-header purple" id="controlsHeader">Controls</div>
<div class="controls-sliders" id="controlsSliders">
<div class="slider-group">
<div class="slider-header">
<label class="control-label">Offset X</label>
<span class="slider-value" id="offsetXValue">0%</span>
</div>
<input type="range" id="offsetX" min="0" max="100" value="0">
</div>
<div class="slider-group">
<div class="slider-header">
<label class="control-label">Offset Y</label>
<span class="slider-value" id="offsetYValue">0%</span>
</div>
<input type="range" id="offsetY" min="0" max="100" value="0">
</div>
<div class="slider-group" style="min-width:300px">
<div class="slider-header">
<label class="control-label">Scale</label>
<span class="slider-value" id="scaleValue">1.0√ó</span>
</div>
<input type="range" id="patternScale" min="0.05" max="5" step="0.01" value="1">
</div>
<div class="slider-group" style="min-width:300px">
<div class="slider-header">
<label class="control-label">Zoom</label>
<span class="slider-value" id="zoomValue">100%</span>
</div>
<input type="range" id="zoomSlider" min="1" max="800" step="1" value="100">
</div>
</div>
</div>
<div class="dropdown-section">
<div class="controls-header green" id="mockupHeader">More</div>
<div class="controls-sliders" id="mockupSliders">
<div class="slider-group" style="min-width:300px">
<div class="slider-header">
<label class="control-label">Mockup Zoom</label>
<span class="slider-value" id="mockupZoomValue">100%</span>
</div>
<input type="range" id="mockupZoom" min="100" max="150" step="1" value="100">
</div>
<div class="slider-group" style="min-width:300px">
<div class="slider-header">
<label class="control-label">Mockup Rotate</label>
<span class="slider-value" id="mockupRotateValue">0¬∞</span>
</div>
<input type="range" id="mockupRotate" min="0" max="360" step="1" value="0">
</div>
</div>
</div>
</div>
<div class="pattern-info" id="patternInfo">
<strong>Pattern:</strong> <span id="infoText"></span> <strong>| Canvas:</strong> <span id="canvasInfo">1200px (Standard)</span>
</div>
</div>
<div id="footer">
<div class="footer-content">
<div class="footer-title">Turn your patterns into real products!</div>
<div class="footer-links">
<a href="https://www.spoonflower.com/" target="_blank">Spoonflower</a>
<a href="https://www.printful.com/" target="_blank">Printful</a>
<a href="https://printify.com/" target="_blank">Printify</a>
<a href="https://society6.com/" target="_blank">Society6</a>
<a href="https://www.redbubble.com/" target="_blank">Redbubble</a>
<a href="https://www.zazzle.com/" target="_blank">Zazzle</a>
</div>
<div class="footer-credit">Created by Rudeboy‚Ñ¢</div>
</div>
</div>
</div>
<div class="loading-overlay" id="loadingOverlay">
<img class="loading-logo" src="https://raw.githubusercontent.com/1gby/seamless-checker/main/assets/icons/icon.png" alt="Loading">
</div>
<script>
function rr(c,x,y,w,h,r){c.beginPath();c.moveTo(x+r,y);c.lineTo(x+w-r,y);c.arcTo(x+w,y,x+w,y+r,r);c.lineTo(x+w,y+h-r);c.arcTo(x+w,y+h,x+w-r,y+h,r);c.lineTo(x+r,y+h);c.arcTo(x,y+h,x,y+h-r,r);c.lineTo(x,y+r);c.arcTo(x,y,x+r,y,r);c.closePath()}
function snap(val,step){return Math.round(val/step)*step}
function snapScale(val){if(val>=0.25)return snap(val,0.25);return Math.max(0.05,snap(val,0.01))}
function snapZoom(val){if(val>=25)return snap(val,25);return Math.max(1,Math.round(val))}
const d=document,g=d.getElementById.bind(d),c=g('canvas'),x=c.getContext('2d'),fi=g('fileInput'),ub=g('uploadBtnHeader'),ss=g('sampleSelect'),eb=g('exportBtnHeader'),rs=g('repeatType'),vm=g('viewMode'),bc=g('bgColor'),ps=g('patternScale'),ox=g('offsetX'),oy=g('offsetY'),sv=g('scaleValue'),oxv=g('offsetXValue'),oyv=g('offsetYValue'),es=g('emptyState'),pi=g('patternInfo'),it=g('infoText'),zs=g('zoomSlider'),zv=g('zoomValue'),ch=g('controlsHeader'),cs=g('controlsSliders'),mh=g('mockupHeader'),ms=g('mockupSliders'),mz=g('mockupZoom'),mzv=g('mockupZoomValue'),mr=g('mockupRotate'),mrv=g('mockupRotateValue'),cq=g('canvasQuality'),ci=g('canvasInfo'),lo=g('loadingOverlay');
let t=null,rt='full',bg='checker',v='tile',s=1,opx=0,opy=0,px=0,py=0,z=1,mockupZoom=1,mockupRotate=0,dr=false,dsx,dsy,phi=null,bti=null,tti=null,bai=null,bsi=null,ipi=null,mui=null,maxCanvasSize=1200;
const MZ=0.01,XZ=8;
const qualityNames={1200:'Standard',1600:'High',2400:'Ultra',3200:'Max'};
function showLoading(){lo.classList.add('visible')}
function hideLoading(){lo.classList.remove('visible')}
(()=>{phi=new Image();phi.crossOrigin='anonymous';phi.src='https://raw.githubusercontent.com/1gby/seamless-checker/main/assets/Mockups/iphone.png';phi.onerror=()=>console.error('Phone fail');phi.onload=()=>{if(t)draw()};bti=new Image();bti.crossOrigin='anonymous';bti.src='https://raw.githubusercontent.com/1gby/seamless-checker/main/assets/Mockups/bottle.png';bti.onerror=()=>console.error('Bottle fail');bti.onload=()=>{if(t)draw()};tti=new Image();tti.crossOrigin='anonymous';tti.src='https://raw.githubusercontent.com/1gby/seamless-checker/main/assets/Mockups/tote.png';tti.onerror=()=>console.error('Tote fail');tti.onload=()=>{if(t)draw()};bai=new Image();bai.crossOrigin='anonymous';bai.src='https://raw.githubusercontent.com/1gby/seamless-checker/main/assets/Mockups/bandana.png';bai.onerror=()=>console.error('Bandana fail');bai.onload=()=>{if(t)draw()};bsi=new Image();bsi.crossOrigin='anonymous';bsi.src='https://raw.githubusercontent.com/1gby/seamless-checker/main/assets/Mockups/bedspread.png';bsi.onerror=()=>console.error('Bedspread fail');bsi.onload=()=>{if(t)draw()};ipi=new Image();ipi.crossOrigin='anonymous';ipi.src='https://raw.githubusercontent.com/1gby/seamless-checker/main/assets/Mockups/ipad.png';ipi.onerror=()=>console.error('iPad fail');ipi.onload=()=>{if(t)draw()};mui=new Image();mui.crossOrigin='anonymous';mui.src='https://raw.githubusercontent.com/1gby/seamless-checker/main/assets/Mockups/mug.png';mui.onerror=()=>console.error('Mug fail');mui.onload=()=>{if(t)draw()}})();
function updateCanvasInfo(){ci.textContent=`${maxCanvasSize}px (${qualityNames[maxCanvasSize]})`}
function resize(){const w=g('canvas-wrapper'),sz=Math.min(w.clientWidth-64,maxCanvasSize);c.width=sz;c.height=sz;uBg();updateCanvasInfo();draw()}
window.addEventListener('resize',resize);resize();
g('logo').addEventListener('click',()=>location.reload());
c.addEventListener('click',e=>{if(!t&&!dr)fi.click()});
ub.addEventListener('click',()=>fi.click());
ss.addEventListener('change',e=>{const url=e.target.value;if(!url)return;showLoading();t=new Image();t.crossOrigin='anonymous';t.onload=()=>{s=Math.max(0.05,Math.min(5,300/t.width));ps.value=s;sv.textContent=s.toFixed(2)+'√ó';uBg();uInfo();draw();hideLoading();e.target.value=''};t.onerror=()=>{hideLoading();alert('Failed to load sample!');e.target.value=''};t.src=url});
ch.addEventListener('click',()=>{cs.classList.toggle('open');ch.classList.toggle('open')});
mh.addEventListener('click',()=>{ms.classList.toggle('open');mh.classList.toggle('open')});
cq.addEventListener('change',e=>{maxCanvasSize=parseInt(e.target.value);resize()});
function uBg(){if(t){c.style.background=bg==='checker'?'repeating-conic-gradient(#ccc 0% 25%,#999 0% 50%,#ccc 50% 75%,#999 75% 100%)':bg;c.style.backgroundSize=bg==='checker'?'40px 40px':'100% 100%'}else{c.style.background='repeating-conic-gradient(#2a2a2a 0% 25%,#1a1a1a 0% 50%,#2a2a2a 50% 75%,#1a1a1a 75% 100%)';c.style.backgroundSize='40px 40px'}}
function uInfo(){if(t){const sz=`${t.width} √ó ${t.height}px`,w=(t.width<3000||t.height<3000)?' ‚ö†Ô∏è Recommended: 3000√ó3000px minimum':' ‚úÖ';it.innerHTML=sz+w;pi.classList.add('visible')}else pi.classList.remove('visible')}
function dpc(ctx,sx,sy,w,h,ts){const tx=Math.ceil(w/ts)+4,ty=Math.ceil(h/ts)+4;ctx.imageSmoothingEnabled=true;ctx.imageSmoothingQuality='high';for(let i=-2;i<tx;i++)for(let j=-2;j<ty;j++){let dx=sx+i*ts+opx*ts,dy=sy+j*ts+opy*ts;if(rt==='half-drop')dy+=(Math.abs(i)%2===1)?ts/2:0;else if(rt==='brick')dx+=(Math.abs(j)%2===1)?ts/2:0;ctx.drawImage(t,dx,dy,ts,ts)}}
function drawMockup(img){if(!img||!img.complete||!img.naturalWidth)return;const ds=Math.min(c.width,c.height)*0.6*1.2*mockupZoom,pc=d.createElement('canvas');pc.width=ds;pc.height=ds;const pCtx=pc.getContext('2d');pCtx.save();pCtx.translate(ds/2,ds/2);pCtx.scale(z,z);pCtx.translate(-ds/2,-ds/2);dpc(pCtx,0,0,ds,ds,t.width*s);pCtx.restore();const mc=d.createElement('canvas');mc.width=ds;mc.height=ds;const mCtx=mc.getContext('2d');mCtx.drawImage(img,0,0,ds,ds);const imgData=mCtx.getImageData(0,0,ds,ds),data=imgData.data;for(let i=0;i<data.length;i+=4)data[i+3]===0?(data[i]=255,data[i+1]=255,data[i+2]=255,data[i+3]=255):data[i+3]=0;mCtx.putImageData(imgData,0,0);pCtx.globalCompositeOperation='destination-in';pCtx.drawImage(mc,0,0);x.save();x.rotate(mockupRotate*Math.PI/180);x.drawImage(pc,-ds/2,-ds/2);x.restore();const oc=d.createElement('canvas');oc.width=ds;oc.height=ds;const oCtx=oc.getContext('2d');oCtx.drawImage(img,0,0,ds,ds);const oData=oCtx.getImageData(0,0,ds,ds).data;for(let i=0;i<oData.length;i+=4)if(oData[i+1]>100&&oData[i]<100&&oData[i+2]<100)oData[i+3]=0;oCtx.putImageData(new ImageData(oData,ds,ds),0,0);x.save();x.rotate(mockupRotate*Math.PI/180);x.drawImage(oc,-ds/2,-ds/2);x.restore()}
function draw(){x.clearRect(0,0,c.width,c.height);if(!t){es.classList.add('visible');c.classList.remove('has-image');eb.disabled=true;return}es.classList.remove('visible');c.classList.add('has-image');eb.disabled=false;const ts=t.width*s,sg=v==='tile-grid';x.imageSmoothingEnabled=true;x.imageSmoothingQuality='high';x.save();if(v==='tile'||v==='tile-grid'){x.translate(px,py);x.scale(z,z);const tx=Math.ceil(c.width/ts/z)+6,ty=Math.ceil(c.height/ts/z)+6,stx=Math.floor(-px/(ts*z))-3,sty=Math.floor(-py/(ts*z))-3;for(let i=stx;i<stx+tx;i++)for(let j=sty;j<sty+ty;j++){let dx=i*ts+opx*ts,dy=j*ts+opy*ts;if(rt==='half-drop')dy+=(Math.abs(i)%2===1)?ts/2:0;else if(rt==='brick')dx+=(Math.abs(j)%2===1)?ts/2:0;x.drawImage(t,dx,dy,ts,ts)}if(sg){x.strokeStyle='rgba(255,255,255,0.4)';x.lineWidth=1/z;for(let i=stx;i<stx+tx+1;i++){let lx=i*ts+opx*ts;x.beginPath();x.moveTo(lx,sty*ts-ts);x.lineTo(lx,(sty+ty+1)*ts);x.stroke()}for(let j=sty;j<sty+ty+1;j++){let ly=j*ts+opy*ts;x.beginPath();x.moveTo(stx*ts-ts,ly);x.lineTo((stx+tx+1)*ts,ly);x.stroke()}}}else{const cx=c.width/2,cy=c.height/2,ms=Math.min(c.width,c.height)*0.6;x.translate(cx,cy);if(v==='phone')drawMockup(phi);else if(v==='ipad')drawMockup(ipi);else if(v==='tote')drawMockup(tti);else if(v==='bandana')drawMockup(bai);else if(v==='bedspread')drawMockup(bsi);else if(v==='mug')drawMockup(mui);else if(v==='bottle')drawMockup(bti);else if(v==='fabric'){const fw=ms*0.95,fh=fw*0.8;x.save();rr(x,-fw/2,-fh/2,fw,fh,15);x.fillStyle='#2a2a2a';x.fill();x.strokeStyle='#444';x.lineWidth=2;x.stroke();x.clip();dpc(x,-fw/2,-fh/2,fw,fh,ts);x.restore()}}x.restore()}
function li(f){if(!f)return;showLoading();const r=new FileReader();r.onload=e=>{t=new Image();t.onload=()=>{s=Math.max(0.05,Math.min(5,300/t.width));ps.value=s;sv.textContent=s.toFixed(2)+'√ó';uBg();uInfo();draw();hideLoading()};t.onerror=()=>{hideLoading();alert('Failed to load image!')};t.src=e.target.result};r.readAsDataURL(f)}
fi.addEventListener('change',e=>li(e.target.files[0]));
c.addEventListener('dragover',e=>{e.preventDefault();c.style.opacity='0.7'});
c.addEventListener('dragleave',()=>c.style.opacity='1');
c.addEventListener('drop',e=>{e.preventDefault();c.style.opacity='1';li(e.dataTransfer.files[0])});
c.addEventListener('pointerdown',e=>{if(!t||(v!=='tile'&&v!=='tile-grid'))return;dr=true;dsx=e.clientX-px;dsy=e.clientY-py;c.setPointerCapture(e.pointerId)});
c.addEventListener('pointermove',e=>{if(!dr||(v!=='tile'&&v!=='tile-grid'))return;px=e.clientX-dsx;py=e.clientY-dsy;draw()});
c.addEventListener('pointerup',()=>dr=false);
c.addEventListener('pointerleave',()=>dr=false);
c.addEventListener('wheel',e=>{if(!t)return;e.preventDefault();const zf=e.deltaY<0?1.1:0.9,r=c.getBoundingClientRect(),mx=e.clientX-r.left,my=e.clientY-r.top;let nz=z*zf;nz=Math.max(MZ,Math.min(XZ,nz));const sc=nz-z;px-=(mx-px)*(sc/z);py-=(my-py)*(sc/z);z=nz;zs.value=Math.round(z*100);zv.textContent=Math.round(z*100)+'%';draw()},{passive:false});
let ltd=0;
c.addEventListener('touchstart',e=>{if(e.touches.length===2&&t){e.preventDefault();const t1=e.touches[0],t2=e.touches[1];ltd=Math.hypot(t2.clientX-t1.clientX,t2.clientY-t1.clientY)}},{passive:false});
c.addEventListener('touchmove',e=>{if(e.touches.length===2&&t){e.preventDefault();const t1=e.touches[0],t2=e.touches[1],cd=Math.hypot(t2.clientX-t1.clientX,t2.clientY-t1.clientY);if(ltd>0){const zf=cd/ltd,r=c.getBoundingClientRect(),cx=((t1.clientX+t2.clientX)/2)-r.left,cy=((t1.clientY+t2.clientY)/2)-r.top;let nz=z*zf;nz=Math.max(MZ,Math.min(XZ,nz));const sc=nz-z;px-=(cx-px)*(sc/z);py-=(cy-py)*(sc/z);z=nz;zs.value=Math.round(z*100);zv.textContent=Math.round(z*100)+'%';draw()}ltd=cd}},{passive:false});
c.addEventListener('touchend',()=>ltd=0);
rs.addEventListener('change',e=>{rt=e.target.value;draw()});
vm.addEventListener('change',e=>{v=e.target.value;draw()});
bc.addEventListener('change',e=>{bg=e.target.value;uBg();draw()});
ps.addEventListener('input',e=>{const raw=parseFloat(e.target.value);s=raw;sv.textContent=s.toFixed(2)+'√ó';draw()});
ps.addEventListener('change',e=>{const raw=parseFloat(e.target.value);s=snapScale(raw);ps.value=s;sv.textContent=s.toFixed(2)+'√ó';draw()});
zs.addEventListener('input',e=>{const raw=parseInt(e.target.value);z=raw/100;zv.textContent=raw+'%';draw()});
zs.addEventListener('change',e=>{const raw=parseInt(e.target.value);const snapped=snapZoom(raw);z=snapped/100;zs.value=snapped;zv.textContent=snapped+'%';draw()});
ox.addEventListener('input',e=>{const raw=parseInt(e.target.value);opx=raw/100;oxv.textContent=raw+'%';draw()});
ox.addEventListener('change',e=>{const raw=parseInt(e.target.value);const snapped=snap(raw,10);opx=snapped/100;ox.value=snapped;oxv.textContent=snapped+'%';draw()});
oy.addEventListener('input',e=>{const raw=parseInt(e.target.value);opy=raw/100;oyv.textContent=raw+'%';draw()});
oy.addEventListener('change',e=>{const raw=parseInt(e.target.value);const snapped=snap(raw,10);opy=snapped/100;oy.value=snapped;oyv.textContent=snapped+'%';draw()});
mz.addEventListener('input',e=>{mockupZoom=parseInt(e.target.value)/100;mzv.textContent=e.target.value+'%';draw()});
mr.addEventListener('input',e=>{mockupRotate=parseInt(e.target.value);mrv.textContent=e.target.value+'¬∞';draw()});
eb.addEventListener('click',async()=>{if(!t){alert('Please load a pattern first!');return}try{const blob=await new Promise(res=>c.toBlob(res,'image/png'));const file=new File([blob],'rudeboy-pattern.png',{type:'image/png'});if(navigator.share&&navigator.canShare&&navigator.canShare({files:[file]})){await navigator.share({files:[file],title:'Rudeboy Pattern',text:'Check out my pattern!'})}else{const l=d.createElement('a');l.download='rudeboy-pattern.png';l.href=URL.createObjectURL(blob);l.click();URL.revokeObjectURL(l.href)}}catch(e){alert('Share failed! Trying download...');try{const l=d.createElement('a');l.download='rudeboy-pattern.png';l.href=c.toDataURL('image/png');l.click()}catch(e2){alert('Download also failed!')}}});
draw();
</script>
</body>
</html>