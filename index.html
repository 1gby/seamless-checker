<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rudeboy‚Ñ¢ Seamless Pattern Checker</title>
<style>
  * { box-sizing: border-box; }
  body { 
    margin:0; 
    padding:0; 
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
    color:#eee;
    min-height: 100vh;
  }

#container {
display:flex;
flex-direction:column;
min-height: 100vh;
}

#header {
padding: 1.5rem 2rem;
background: rgba(26, 26, 46, 0.8);
backdrop-filter: blur(10px);
border-bottom: 1px solid rgba(255, 255, 255, 0.1);
display: flex;
align-items: center;
justify-content: space-between;
gap: 1rem;
flex-wrap: wrap;
}

.logo-section {
display: flex;
align-items: center;
gap: 1rem;
}

#logo {
height: 42px;
width: auto;
cursor: pointer;
transition: transform 0.3s ease;
}

#logo:hover {
transform: scale(1.05);
}

.title {
font-size: 1.5rem;
font-weight: 700;
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
background-clip: text;
margin: 0;
}

.file-upload-section {
display: flex;
align-items: center;
gap: 0.8rem;
}

.file-input-wrapper {
position: relative;
overflow: hidden;
display: inline-block;
}

.file-input-wrapper input[type=file] {
position: absolute;
left: -9999px;
}

.upload-btn {
padding: 0.75rem 1.5rem;
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
color: white;
border: none;
border-radius: 12px;
font-size: 0.95rem;
font-weight: 600;
cursor: pointer;
transition: all 0.3s ease;
box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.upload-btn:hover {
transform: translateY(-2px);
box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
}

#canvas-wrapper {
flex: 1;
display: flex;
align-items: center;
justify-content: center;
padding: 2rem;
position: relative;
}

#canvas {
max-width: 800px;
width: 100%;
aspect-ratio: 1;
border-radius: 20px;
box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
cursor: pointer;
transition: all 0.3s ease;
background: repeating-conic-gradient(#2a2a2a 0% 25%, #1a1a1a 0% 50%, #2a2a2a 50% 75%, #1a1a1a 75% 100%) !important;
background-size: 40px 40px !important;
}

#canvas.has-image {
cursor: grab;
}

#canvas.has-image:active {
cursor: grabbing;
}

#canvas:hover {
box-shadow: 0 25px 70px rgba(0, 0, 0, 0.6);
}

.empty-state {
position: absolute;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
text-align: center;
pointer-events: none;
opacity: 0;
transition: opacity 0.3s ease;
}

.empty-state.visible {
opacity: 1;
}

.empty-state-icon {
font-size: 4rem;
margin-bottom: 1rem;
opacity: 0.6;
}

.empty-state-text {
font-size: 1.25rem;
font-weight: 600;
margin-bottom: 0.5rem;
color: #888;
}

.empty-state-subtext {
font-size: 0.95rem;
color: #666;
}

#controls {
padding: 2rem;
background: rgba(26, 26, 46, 0.8);
backdrop-filter: blur(10px);
border-top: 1px solid rgba(255, 255, 255, 0.1);
display: flex;
gap: 1.5rem;
justify-content: center;
flex-wrap: wrap;
align-items: center;
}

.control-group {
display: flex;
flex-direction: column;
gap: 0.5rem;
min-width: 180px;
}

.control-label {
font-size: 0.85rem;
font-weight: 600;
color: #aaa;
text-transform: uppercase;
letter-spacing: 0.5px;
}

select, button {
padding: 0.75rem 1rem;
font-size: 0.95rem;
border-radius: 12px;
border: 1px solid rgba(255, 255, 255, 0.1);
background: rgba(255, 255, 255, 0.05);
color: #eee;
cursor: pointer;
transition: all 0.3s ease;
font-family: inherit;
}

select:hover, button:hover {
background: rgba(255, 255, 255, 0.1);
border-color: rgba(102, 126, 234, 0.5);
}

select:focus, button:focus {
outline: none;
border-color: #667eea;
box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
}

button.primary {
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
border: none;
font-weight: 600;
box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

button.primary:hover {
transform: translateY(-2px);
box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
}

.slider-group {
display: flex;
flex-direction: column;
gap: 0.5rem;
min-width: 180px;
}

.slider-header {
display: flex;
justify-content: space-between;
align-items: center;
}

input[type=‚Äúrange‚Äù] {
width: 100%;
height: 6px;
border-radius: 3px;
background: rgba(255, 255, 255, 0.1);
outline: none;
-webkit-appearance: none;
}

input[type=‚Äúrange‚Äù]::-webkit-slider-thumb {
-webkit-appearance: none;
appearance: none;
width: 18px;
height: 18px;
border-radius: 50%;
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
cursor: pointer;
box-shadow: 0 2px 8px rgba(102, 126, 234, 0.4);
transition: all 0.3s ease;
}

input[type=‚Äúrange‚Äù]::-webkit-slider-thumb:hover {
transform: scale(1.2);
}

input[type=‚Äúrange‚Äù]::-moz-range-thumb {
width: 18px;
height: 18px;
border-radius: 50%;
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
cursor: pointer;
border: none;
box-shadow: 0 2px 8px rgba(102, 126, 234, 0.4);
transition: all 0.3s ease;
}

input[type=‚Äúrange‚Äù]::-moz-range-thumb:hover {
transform: scale(1.2);
}

.slider-value {
font-size: 0.9rem;
font-weight: 600;
color: #667eea;
min-width: 45px;
text-align: right;
}

#footer {
padding: 2rem;
background: rgba(10, 10, 10, 0.9);
border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.footer-content {
max-width: 1200px;
margin: 0 auto;
text-align: center;
}

.footer-title {
font-size: 1.1rem;
font-weight: 600;
margin-bottom: 1rem;
color: #aaa;
}

.footer-links {
display: flex;
flex-wrap: wrap;
gap: 1.5rem;
justify-content: center;
margin-bottom: 1.5rem;
}

.footer-links a {
color: #667eea;
text-decoration: none;
font-size: 0.95rem;
transition: all 0.3s ease;
padding: 0.5rem 1rem;
border-radius: 8px;
background: rgba(102, 126, 234, 0.1);
}

.footer-links a:hover {
background: rgba(102, 126, 234, 0.2);
transform: translateY(-2px);
}

.footer-credit {
margin-top: 1.5rem;
padding-top: 1.5rem;
border-top: 1px solid rgba(255, 255, 255, 0.1);
font-weight: 700;
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
background-clip: text;
font-size: 1.1rem;
}

.helper-text {
font-size: 0.85rem;
color: #888;
text-align: center;
margin-top: 1rem;
}

@media (max-width: 768px) {
#header {
padding: 1rem;
}

```
.title {
  font-size: 1.2rem;
}

#canvas-wrapper {
  padding: 1rem;
}

#controls {
  padding: 1.5rem 1rem;
  gap: 1rem;
}

.control-group, .slider-group {
  min-width: 140px;
}
```

}
</style>

</head>
<body>
<div id="container">
  <div id="header">
    <div class="logo-section">
      <img id="logo" src="https://i.imgur.com/tlVfJ54.png" alt="Rud3boy Logo">
      <h1 class="title">Pattern Checker</h1>
    </div>
    <div class="file-upload-section">
      <div class="file-input-wrapper">
        <input type="file" id="fileInput" accept="image/*">
        <button class="upload-btn" id="uploadBtnHeader">
          <span>üìÅ Upload Pattern</span>
        </button>
      </div>
    </div>
  </div>

  <div id="canvas-wrapper">
    <canvas id="canvas"></canvas>
    <div class="empty-state visible" id="emptyState">
      <div class="empty-state-icon">üé®</div>
      <div class="empty-state-text">Click to upload your pattern</div>
      <div class="empty-state-subtext">or drag & drop a square tile here</div>
    </div>
  </div>

  <div id="controls">
    <div class="control-group">
      <label class="control-label">Repeat Type</label>
      <select id="repeatType">
        <option value="full">Full Drop</option>
        <option value="half-drop">Half Drop</option>
        <option value="brick">Brick</option>
      </select>
    </div>

```
<div class="control-group">
  <label class="control-label">View Mode</label>
  <select id="viewMode">
    <option value="tile">Infinite Tile</option>
    <option value="phone">Phone Case</option>
    <option value="fabric">Fabric Swatch</option>
    <option value="bottle">Water Bottle</option>
  </select>
</div>

<div class="control-group">
  <label class="control-label">Background</label>
  <select id="bgColor">
    <option value="checker">Transparent</option>
    <option value="#000000">Black</option>
    <option value="#ffffff">White</option>
  </select>
</div>

<div class="control-group">
  <label class="control-label">Grid</label>
  <button id="toggleGrid">Show Grid</button>
</div>

<div class="slider-group">
  <div class="slider-header">
    <label class="control-label">Scale</label>
    <span class="slider-value" id="scaleValue">1.0√ó</span>
  </div>
  <input type="range" id="patternScale" min="0.3" max="3" step="0.1" value="1">
</div>

<div class="slider-group">
  <div class="slider-header">
    <label class="control-label">Offset X</label>
    <span class="slider-value" id="offsetXValue">0%</span>
  </div>
  <input type="range" id="offsetX" min="0" max="100" value="0">
</div>

<div class="slider-group">
  <div class="slider-header">
    <label class="control-label">Offset Y</label>
    <span class="slider-value" id="offsetYValue">0%</span>
  </div>
  <input type="range" id="offsetY" min="0" max="100" value="0">
</div>

<div class="control-group">
  <label class="control-label">Export</label>
  <button class="primary" id="exportBtn">üíæ Export PNG</button>
</div>
```

  </div>

  <p class="helper-text">Wheel/Pinch to zoom ‚Ä¢ Drag to pan in tile mode</p>
</div>

<div id="footer">
  <div class="footer-content">
    <div class="footer-title">Turn your patterns into real products!</div>
    <div class="footer-links">
      <a href="https://www.spoonflower.com/" target="_blank">Spoonflower</a>
      <a href="https://www.printful.com/" target="_blank">Printful</a>
      <a href="https://printify.com/" target="_blank">Printify</a>
      <a href="https://society6.com/" target="_blank">Society6</a>
      <a href="https://www.redbubble.com/" target="_blank">Redbubble</a>
      <a href="https://www.zazzle.com/" target="_blank">Zazzle</a>
    </div>
    <div class="footer-credit">Created by Rudeboy‚Ñ¢</div>
  </div>
</div>

<script>
function roundRect(ctx, x, y, width, height, radius) {
  ctx.beginPath();
  ctx.moveTo(x + radius, y);
  ctx.lineTo(x + width - radius, y);
  ctx.arcTo(x + width, y, x + width, y + radius, radius);
  ctx.lineTo(x + width, y + height - radius);
  ctx.arcTo(x + width, y + height, x + width - radius, y + height, radius);
  ctx.lineTo(x + radius, y + height);
  ctx.arcTo(x, y + height, x, y + height - radius, radius);
  ctx.lineTo(x, y + radius);
  ctx.arcTo(x, y, x + radius, y, radius);
  ctx.closePath();
}

const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const fileInput = document.getElementById('fileInput');
const uploadBtnHeader = document.getElementById('uploadBtnHeader');
const toggleGridBtn = document.getElementById('toggleGrid');
const repeatSelect = document.getElementById('repeatType');
const viewModeSelect = document.getElementById('viewMode');
const bgColorSelect = document.getElementById('bgColor');
const exportBtn = document.getElementById('exportBtn');
const scaleSlider = document.getElementById('patternScale');
const offsetXSlider = document.getElementById('offsetX');
const offsetYSlider = document.getElementById('offsetY');
const scaleValue = document.getElementById('scaleValue');
const offsetXValue = document.getElementById('offsetXValue');
const offsetYValue = document.getElementById('offsetYValue');
const emptyState = document.getElementById('emptyState');

let tileImg = null;
let showGrid = false;
let repeatType = 'full';
let bgColor = 'checker';
let viewMode = 'tile';
let patternScale = 1;
let offsetPercentX = 0;
let offsetPercentY = 0;

let offsetX = 0, offsetY = 0, scale = 1;
let isDragging = false, startX, startY;

const MIN_ZOOM = 0.1;
const MAX_ZOOM = 5;

function resize() {
  const wrapper = document.getElementById('canvas-wrapper');
  const availableWidth = Math.min(wrapper.clientWidth - 64, 800);
  canvas.width = availableWidth;
  canvas.height = availableWidth;
  
  updateBackground();
  draw();
}
window.addEventListener('resize', resize);
resize();

document.getElementById('logo').addEventListener('click', () => {
  location.reload();
});

// Click on canvas to upload when empty
canvas.addEventListener('click', (e) => {
  if (!tileImg && !isDragging) {
    fileInput.click();
  }
});

// Upload button in header
uploadBtnHeader.addEventListener('click', () => {
  fileInput.click();
});

function updateBackground() {
  if (tileImg) {
    canvas.style.background = bgColor === 'checker' 
      ? 'repeating-conic-gradient(#ccc 0% 25%, #999 0% 50%, #ccc 50% 75%, #999 75% 100%)' 
      : bgColor;
    canvas.style.backgroundSize = '40px 40px';
  } else {
    canvas.style.background = 'repeating-conic-gradient(#2a2a2a 0% 25%, #1a1a1a 0% 50%, #2a2a2a 50% 75%, #1a1a1a 75% 100%)';
    canvas.style.backgroundSize = '40px 40px';
  }
}

function drawPattern(startX, startY, width, height, tileSize) {
  const tilesX = Math.ceil(width / tileSize) + 4;
  const tilesY = Math.ceil(height / tileSize) + 4;
  
  ctx.imageSmoothingEnabled = true;
  ctx.imageSmoothingQuality = 'high';
  
  for (let x = -2; x < tilesX; x++) {
    for (let y = -2; y < tilesY; y++) {
      let drawX = startX + x * tileSize + offsetPercentX * tileSize;
      let drawY = startY + y * tileSize + offsetPercentY * tileSize;

      if (repeatType === 'half-drop') {
        drawY += (Math.abs(x) % 2 === 1) ? tileSize / 2 : 0;
      } else if (repeatType === 'brick') {
        drawX += (Math.abs(y) % 2 === 1) ? tileSize / 2 : 0;
      }

      ctx.drawImage(tileImg, drawX, drawY, tileSize, tileSize);
    }
  }
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  
  if (!tileImg) {
    emptyState.classList.add('visible');
    canvas.classList.remove('has-image');
    return;
  }
  
  emptyState.classList.remove('visible');
  canvas.classList.add('has-image');

  const baseTileSize = tileImg.width;
  const effectiveTileSize = baseTileSize * patternScale;

  ctx.imageSmoothingEnabled = true;
  ctx.imageSmoothingQuality = 'high';

  ctx.save();

  if (viewMode === 'tile') {
    ctx.translate(offsetX, offsetY);
    ctx.scale(scale, scale);

    const tilesX = Math.ceil(canvas.width / effectiveTileSize / scale) + 6;
    const tilesY = Math.ceil(canvas.height / effectiveTileSize / scale) + 6;
    const startTileX = Math.floor(-offsetX / (effectiveTileSize * scale)) - 3;
    const startTileY = Math.floor(-offsetY / (effectiveTileSize * scale)) - 3;

    for (let x = startTileX; x < startTileX + tilesX; x++) {
      for (let y = startTileY; y < startTileY + tilesY; y++) {
        let drawX = x * effectiveTileSize + offsetPercentX * effectiveTileSize;
        let drawY = y * effectiveTileSize + offsetPercentY * effectiveTileSize;

        if (repeatType === 'half-drop') drawY += (Math.abs(x) % 2 === 1) ? effectiveTileSize / 2 : 0;
        else if (repeatType === 'brick') drawX += (Math.abs(y) % 2 === 1) ? effectiveTileSize / 2 : 0;

        ctx.drawImage(tileImg, drawX, drawY, effectiveTileSize, effectiveTileSize);
      }
    }

    if (showGrid) {
      ctx.strokeStyle = 'rgba(255,255,255,0.4)';
      ctx.lineWidth = 1 / scale;

      for (let x = startTileX; x < startTileX + tilesX + 1; x++) {
        let lineX = x * effectiveTileSize + offsetPercentX * effectiveTileSize;
        ctx.beginPath();
        ctx.moveTo(lineX, startTileY * effectiveTileSize - effectiveTileSize);
        ctx.lineTo(lineX, (startTileY + tilesY + 1) * effectiveTileSize);
        ctx.stroke();
      }
      for (let y = startTileY; y < startTileY + tilesY + 1; y++) {
        let lineY = y * effectiveTileSize + offsetPercentY * effectiveTileSize;
        ctx.beginPath();
        ctx.moveTo(startTileX * effectiveTileSize - effectiveTileSize, lineY);
        ctx.lineTo((startTileX + tilesX + 1) * effectiveTileSize, lineY);
        ctx.stroke();
      }
    }
  } else {
    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;
    const mockupSize = Math.min(canvas.width, canvas.height) * 0.6;

    ctx.translate(centerX, centerY);

    if (viewMode === 'phone') {
      const phoneWidth = mockupSize * 0.55;
      const phoneHeight = phoneWidth * 2.1;
      const cameraSize = phoneWidth * 0.15;
      const cameraOffset = phoneWidth * 0.15;
      
      ctx.save();
      roundRect(ctx, -phoneWidth/2, -phoneHeight/2, phoneWidth, phoneHeight, 35);
      ctx.clip();
      drawPattern(-phoneWidth/2, -phoneHeight/2, phoneWidth, phoneHeight, effectiveTileSize);
      ctx.restore();
      
      roundRect(ctx, -phoneWidth/2, -phoneHeight/2, phoneWidth, phoneHeight, 35);
      ctx.strokeStyle = '#000';
      ctx.lineWidth = 4;
      ctx.stroke();
      
      ctx.beginPath();
      ctx.arc(-phoneWidth/2 + cameraOffset + cameraSize/2, -phoneHeight/2 + cameraOffset + cameraSize/2, cameraSize/2, 0, Math.PI * 2);
      ctx.fillStyle = '#0a0a0a';
      ctx.fill();
      ctx.strokeStyle = '#222';
      ctx.lineWidth = 2;
      ctx.stroke();
      
    } else if (viewMode === 'fabric') {
      const fabricWidth = mockupSize * 0.95;
      const fabricHeight = fabricWidth * 0.8;
      
      ctx.save();
      roundRect(ctx, -fabricWidth/2, -fabricHeight/2, fabricWidth, fabricHeight, 15);
      ctx.fillStyle = '#2a2a2a';
      ctx.fill();
      ctx.strokeStyle = '#444';
      ctx.lineWidth = 2;
      ctx.stroke();
      ctx.clip();

      drawPattern(-fabricWidth/2, -fabricHeight/2, fabricWidth, fabricHeight, effectiveTileSize);
      ctx.restore();
    } else if (viewMode === 'bottle') {
      const bottleWidth = mockupSize * 0.45;
      const bottleHeight = bottleWidth * 2.3;
      const capHeight = bottleHeight * 0.12;
      const neckHeight = bottleHeight * 0.08;
      const bodyTop = -bottleHeight/2 + capHeight + neckHeight;
      const bodyHeight = bottleHeight - capHeight - neckHeight;
      
      ctx.save();
      roundRect(ctx, -bottleWidth/2, bodyTop, bottleWidth, bodyHeight, 25);
      ctx.clip();
      drawPattern(-bottleWidth/2, bodyTop, bottleWidth, bodyHeight, effectiveTileSize);
      ctx.restore();
      
      roundRect(ctx, -bottleWidth/2, bodyTop, bottleWidth, bodyHeight, 25);
      ctx.strokeStyle = '#000';
      ctx.lineWidth = 3;
      ctx.stroke();
      
      ctx.save();
      roundRect(ctx, -bottleWidth/2, bodyTop, bottleWidth, bodyHeight, 25);
      ctx.clip();
      const gradient = ctx.createLinearGradient(-bottleWidth/2, 0, bottleWidth/2, 0);
      gradient.addColorStop(0, 'rgba(255,255,255,0)');
      gradient.addColorStop(0.3, 'rgba(255,255,255,0.15)');
      gradient.addColorStop(0.5, 'rgba(255,255,255,0.25)');
      gradient.addColorStop(0.7, 'rgba(255,255,255,0.15)');
      gradient.addColorStop(1, 'rgba(255,255,255,0)');
      ctx.fillStyle = gradient;
      ctx.fillRect(-bottleWidth/2, bodyTop, bottleWidth, bodyHeight);
      ctx.restore();
      
      const neckWidth = bottleWidth * 0.6;
      ctx.fillStyle = '#e8e8e8';
      roundRect(ctx, -neckWidth/2, -bottleHeight/2 + capHeight, neckWidth, neckHeight, 8);
      ctx.fill();
      ctx.strokeStyle = '#000';
      ctx.lineWidth = 2;
      ctx.stroke();
      
      const capWidth = bottleWidth * 0.65;
      ctx.fillStyle = '#2a2a2a';
      roundRect(ctx, -capWidth/2, -bottleHeight/2, capWidth, capHeight, 6);
      ctx.fill();
      ctx.strokeStyle = '#000';
      ctx.lineWidth = 2;
      ctx.stroke();
      
      ctx.strokeStyle = '#444';
      ctx.lineWidth = 1;
      for (let i = 0; i < 4; i++) {
        const y = -bottleHeight/2 + (capHeight / 5) * (i + 1);
        ctx.beginPath();
        ctx.moveTo(-capWidth/2 + 2, y);
        ctx.lineTo(capWidth/2 - 2, y);
        ctx.stroke();
      }
      
      ctx.beginPath();
      ctx.ellipse(0, -bottleHeight/2 + 3, capWidth * 0.45, capWidth * 0.12, 0, 0, Math.PI * 2);
      ctx.fillStyle = '#1a1a1a';
      ctx.fill();
      ctx.strokeStyle = '#000';
      ctx.lineWidth = 2;
      ctx.stroke();
      
      ctx.beginPath();
      ctx.ellipse(0, bodyTop + bodyHeight - 5, bottleWidth * 0.48, bottleWidth * 0.08, 0, 0, Math.PI);
      ctx.fillStyle = '#333';
      ctx.fill();
      ctx.strokeStyle = '#000';
      ctx.lineWidth = 2;
      ctx.stroke();
    }
  }

  ctx.restore();
}

function loadImage(file) {
  if (!file) return;
  const reader = new FileReader();
  reader